# Cursor Rules for AI Spec-Driven Development

## ðŸš¨ MANDATORY: Read MASTER.md First
Before generating any code, you MUST read and understand `docs/MASTER.md`.

## Project Context
This is an AI-driven development project that uses a streamlined 7-document structure optimized for AI tools. The project emphasizes "less is more" - fewer, highly-focused documents that AI can effectively parse and understand.

## Key Constraints from MASTER.md

### Type Safety
- Use TypeScript with strict type safety
- No `any` types (use `unknown` or proper types)
- Explicit type definitions for all variables, functions, and API responses
- Use type guards for runtime type checking

### Code Quality
- No magic numbers/hardcoded values (use named constants)
- No `console.log` in production code
- No unused imports or variables
- No error swallowing (always handle errors properly)
- Functions should be under 30 lines (single responsibility principle)

### Naming Conventions
- Variables: camelCase (e.g., `userName`, `isActive`)
- Constants: UPPER_SNAKE_CASE (e.g., `MAX_RETRY_COUNT`)
- Types/Interfaces: PascalCase (e.g., `UserProfile`, `ApiResponse`)
- Files: PascalCase for components, camelCase for utilities

### Error Handling
- Use Result pattern for error handling
- Implement try-catch blocks with proper error messages
- Log errors with structured logging
- Return user-friendly error messages

### Testing
- Generate unit tests for all functions (80%+ coverage target)
- Use AAA pattern (Arrange-Act-Assert)
- Mock dependencies appropriately
- Test both success and error cases

## Architecture Patterns
- Clean Architecture
- Repository Pattern
- CQRS (Command Query Responsibility Segregation)
- Event-Driven Architecture
- Dependency Injection

## Security Requirements
- Input sanitization
- SQL injection prevention
- XSS protection
- CSRF protection
- Proper authentication/authorization
- HTTPS usage
- Environment variable management

## Performance Goals
- Page load time: < 3 seconds
- API response time: < 200ms (95th percentile)
- Concurrent users: 1000

## Implementation Priority
1. **Phase 1: MVP** - Essential features only
2. **Phase 2: Extension** - Additional features
3. **Phase 3: Optimization** - Performance and scalability

## Code Generation Rules

### Before Generating Code
1. Read `docs/MASTER.md` for project context
2. Check `docs/03-implementation/PATTERNS.md` for implementation patterns
3. Verify `docs/02-design/ARCHITECTURE.md` for technical decisions
4. Review `docs/02-design/DOMAIN.md` for business logic

### During Code Generation
1. Follow the coding rules from MASTER.md
2. Use the patterns from PATTERNS.md
3. Implement proper error handling
4. Generate corresponding tests
5. Add appropriate comments

### After Code Generation
1. Verify no magic numbers are used
2. Check type safety
3. Ensure error handling is proper
4. Validate security requirements
5. Confirm performance considerations

## Prohibited Patterns
- âŒ `any` type usage
- âŒ Magic numbers/hardcoded values
- âŒ `console.log` in production
- âŒ Unused imports/variables
- âŒ Error swallowing
- âŒ Functions over 30 lines
- âŒ Inconsistent naming

## Required Patterns
- âœ… TypeScript with strict types
- âœ… Named constants for all values
- âœ… Result pattern for error handling
- âœ… Comprehensive error handling
- âœ… Unit tests for all functions
- âœ… Proper logging
- âœ… Security best practices

## AI Prompt Assistance
When generating code, always include this constraint:

```
åˆ¶ç´„: ãƒžã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼ï¼ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ç¦æ­¢ã€‚æ„å‘³ã®ã‚ã‚‹å€¤ã¯åå‰ä»˜ãå®šæ•°ã¸æŠ½å‡ºã—ã€ç’°å¢ƒå¤‰æ•°ã‚„è¨­å®šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‹ã‚‰æ³¨å…¥ã™ã‚‹ã€‚å˜ä½ï¼ˆms, KB ãªã©ï¼‰ã¨æœ‰åŠ¹ç¯„å›²ã‚’ã‚³ãƒ¡ãƒ³ãƒˆ/åž‹ã§æ˜Žç¤ºã™ã‚‹ã“ã¨ã€‚URL, ãƒ‘ã‚¹, ãƒ˜ãƒƒãƒ€å, ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯å®šæ•°åŒ–ã™ã‚‹ã€‚

æŽ¨å¥¨ãƒ„ãƒ¼ãƒ«:
- Playwright MCPçµ±åˆã«ã‚ˆã‚ŠAIé§†å‹•ã®ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«ãƒ‡ãƒãƒƒã‚°ãƒ»è‡ªå‹•ãƒ†ã‚¹ãƒˆä¿®å¾©ã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã€‚E2Eãƒ†ã‚¹ãƒˆã®å¤±æ•—æ™‚ã¯è‡ªå‹•çš„ã«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆåˆ†æžã¨ä¿®æ­£ææ¡ˆã‚’ç”Ÿæˆã™ã‚‹ã€‚
- Chrome DevTools MCPçµ±åˆã«ã‚ˆã‚Šãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã®DOMæ“ä½œãƒ»ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç›£è¦–ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒžãƒ³ã‚¹åˆ†æžã‚’æ´»ç”¨ã™ã‚‹ã“ã¨ã€‚Webé–‹ç™ºæ™‚ã®ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãªãƒ‡ãƒãƒƒã‚°ã«æœ€é©ã€‚
```

## Document References
- `docs/MASTER.md` - Project overview and rules
- `docs/01-context/PROJECT.md` - Business requirements
- `docs/02-design/ARCHITECTURE.md` - Technical architecture
- `docs/02-design/DOMAIN.md` - Business logic
- `docs/03-implementation/PATTERNS.md` - Implementation patterns
- `docs/04-quality/TESTING.md` - Testing strategies
- `docs/05-operations/DEPLOYMENT.md` - Deployment procedures
- `docs/08-knowledge/` - Knowledge base and best practices

## Code Review Checklist
- [ ] MASTER.md rules followed
- [ ] No magic numbers/hardcoded values
- [ ] Type safety ensured
- [ ] Error handling implemented
- [ ] Tests generated
- [ ] Security requirements met
- [ ] Performance considerations addressed
- [ ] Naming conventions followed
- [ ] Constants properly organized by layer

Remember: Always reference MASTER.md for project-specific requirements and constraints.
