# ユースケーステンプレート

## このドキュメントの目的

ユースケースドキュメントは、**システムの機能要件をアクター（利用者）の視点から整理する**ためのドキュメントです。
「誰が」「何をしたいか」「どうなるべきか」を明確にすることで、要件の漏れを防ぎ、テストケース作成の基盤となります。

### いつ使うか

- 機能要件を網羅的に整理したい
- テストケースの基盤を作りたい
- 開発者とビジネス側で認識を合わせたい
- 複雑なシステムの動作仕様を明確化したい

### 使い方

1. このテンプレートをコピーして、プロジェクト名に変更
2. アクターを定義
3. ユースケース一覧を作成
4. 重要なユースケースから詳細を記述
5. 完成後、`DOMAIN.md`の機能要件と整合性を確認

### 関連ドキュメント

- [PLANNING_TEMPLATE.md](./PLANNING_TEMPLATE.md) - プロジェクト全体の企画書
- [INCEPTION_DECK_TEMPLATE.md](./INCEPTION_DECK_TEMPLATE.md) - アジャイル形式の企画書

---

## プロジェクト基本情報

| 項目 | 内容 |
|------|------|
| プロジェクト名 | [ここに記入] |
| システム名 | [ここに記入] |
| 作成日 | [YYYY-MM-DD] |
| 最終更新 | [YYYY-MM-DD] |
| 作成者 | [名前] |

---

## 1. アクター定義

### 1.1 プライマリアクター（直接システムを利用する）

| アクターID | アクター名 | 説明 | 主な目的 |
|-----------|-----------|------|---------|
| A-001 | [例：一般ユーザー] | [サービスに登録した利用者] | [商品を検索・購入する] |
| A-002 | [例：管理者] | [システム管理を行うスタッフ] | [ユーザー・商品を管理する] |
| A-003 | [ここに記入] | | |

### 1.2 セカンダリアクター（システムと連携する外部システム）

| アクターID | アクター名 | 説明 | 連携内容 |
|-----------|-----------|------|---------|
| S-001 | [例：決済システム] | [クレジットカード決済API] | [決済処理、結果通知] |
| S-002 | [例：メール配信サービス] | [SendGrid API] | [通知メール送信] |
| S-003 | [ここに記入] | | |

### 1.3 アクター関係図

```
[アクター間の関係を図示]

【例】
                    ┌─────────────┐
                    │   システム   │
                    └─────────────┘
                          ▲
         ┌────────────────┼────────────────┐
         │                │                │
    ┌────┴────┐      ┌────┴────┐      ┌────┴────┐
    │一般ユーザー│      │  管理者  │      │決済システム│
    └─────────┘      └─────────┘      └─────────┘
         │
         ├── 登録ユーザー（ログイン済み）
         └── ゲストユーザー（未登録）
```

---

## 2. ユースケース一覧

### 2.1 カテゴリ別ユースケース

#### 認証・アカウント管理

| UC-ID | ユースケース名 | アクター | 優先度 | 状態 |
|-------|--------------|---------|--------|------|
| UC-001 | [例：ユーザー登録] | [一般ユーザー] | 高 | [Draft] |
| UC-002 | [例：ログイン] | [一般ユーザー] | 高 | [Draft] |
| UC-003 | [例：パスワードリセット] | [一般ユーザー] | 中 | [Draft] |
| UC-004 | [ここに記入] | | | |

#### コア機能（例：商品管理）

| UC-ID | ユースケース名 | アクター | 優先度 | 状態 |
|-------|--------------|---------|--------|------|
| UC-101 | [例：商品を検索する] | [一般ユーザー] | 高 | [Draft] |
| UC-102 | [例：商品詳細を閲覧する] | [一般ユーザー] | 高 | [Draft] |
| UC-103 | [例：商品をカートに追加] | [一般ユーザー] | 高 | [Draft] |
| UC-104 | [ここに記入] | | | |

#### 管理機能

| UC-ID | ユースケース名 | アクター | 優先度 | 状態 |
|-------|--------------|---------|--------|------|
| UC-201 | [例：ユーザー一覧を閲覧] | [管理者] | 中 | [Draft] |
| UC-202 | [例：ユーザーを停止する] | [管理者] | 中 | [Draft] |
| UC-203 | [ここに記入] | | | |

### 2.2 ユースケース図

```
[ユースケース図を記載]

【例】
┌──────────────────────────────────────────────────────────────┐
│                        ECシステム                            │
│  ┌─────────────────────────────────────────────────────────┐│
│  │                   <<認証・アカウント>>                    ││
│  │  (ユーザー登録)  (ログイン)  (パスワードリセット)           ││
│  └─────────────────────────────────────────────────────────┘│
│                              ▲                               │
│         ┌────────────────────┼────────────────────┐         │
│         │                    │                    │         │
│  ┌──────┴──────┐     ┌───────┴──────┐    ┌───────┴──────┐  │
│  │<<商品検索>>  │     │<<カート管理>> │    │<<注文処理>>  │  │
│  │             │     │              │    │             │  │
│  │(商品を検索)  │     │(カートに追加) │    │(注文を確定)  │  │
│  │(詳細を閲覧)  │     │(数量を変更)  │    │(履歴を確認)  │  │
│  └─────────────┘     └──────────────┘    └─────────────┘  │
└──────────────────────────────────────────────────────────────┘
       ▲                     ▲                      ▲
       │                     │                      │
  ┌────┴─────┐          ┌────┴────┐           ┌────┴────┐
  │一般ユーザー│          │  管理者 │           │決済API  │
  └──────────┘          └─────────┘           └─────────┘
```

---

## 3. ユースケース詳細

### テンプレート

各ユースケースは以下の形式で記述してください：

---

### UC-XXX: [ユースケース名]

#### 基本情報

| 項目 | 内容 |
|------|------|
| ユースケースID | UC-XXX |
| ユースケース名 | [名前] |
| アクター | [アクター名] |
| 概要 | [一言説明] |
| 優先度 | 高 / 中 / 低 |
| 状態 | Draft / Review / Approved |

#### 事前条件（Preconditions）

- [ ] [例：ユーザーがログインしていること]
- [ ] [例：商品が1件以上登録されていること]

#### 事後条件（Postconditions）

- [ ] [例：注文が確定され、注文番号が発行されること]
- [ ] [例：在庫が減算されること]

#### 基本フロー（Main Flow）

| ステップ | アクター | システム |
|---------|---------|---------|
| 1 | [例：商品詳細画面で「カートに追加」ボタンをクリック] | |
| 2 | | [例：商品をカートに追加し、カート内容を更新] |
| 3 | | [例：「カートに追加しました」メッセージを表示] |
| 4 | [例：「カートを見る」または「買い物を続ける」を選択] | |

#### 代替フロー（Alternative Flows）

**A1: 在庫がない場合（ステップ2で発生）**

| ステップ | アクター | システム |
|---------|---------|---------|
| 2a | | [例：「在庫がありません」エラーを表示] |
| 2b | | [例：「再入荷通知を受け取る」オプションを表示] |

**A2: 未ログインの場合（ステップ1の前に発生）**

| ステップ | アクター | システム |
|---------|---------|---------|
| 0a | | [例：ログイン画面にリダイレクト] |
| 0b | [例：ログインまたはユーザー登録を行う] | |
| 0c | | [例：元の画面に戻す] |

#### 例外フロー（Exception Flows）

**E1: システムエラー**

| ステップ | アクター | システム |
|---------|---------|---------|
| *a | | [例：エラーメッセージを表示] |
| *b | | [例：エラーログを記録] |
| *c | [例：再試行または問い合わせ] | |

#### ビジネスルール

- [例：同一商品は最大10個まで追加可能]
- [例：カート保持期間は30日間]

#### 補足・備考

- [例：カート内容はセッションではなくDBに保存する]
- [例：ゲストユーザーもカート追加可能（ログイン後にマージ）]

---

## 4. ユースケース詳細（記入例）

### UC-001: ユーザー登録

#### 基本情報

| 項目 | 内容 |
|------|------|
| ユースケースID | UC-001 |
| ユースケース名 | ユーザー登録 |
| アクター | 一般ユーザー（未登録） |
| 概要 | 新規ユーザーがアカウントを作成する |
| 優先度 | 高 |
| 状態 | Draft |

#### 事前条件（Preconditions）

- [ ] ユーザーがシステムにアクセスできること
- [ ] メールアドレスが未登録であること

#### 事後条件（Postconditions）

- [ ] ユーザーアカウントが作成されること
- [ ] 確認メールが送信されること
- [ ] ユーザーがログイン状態になること

#### 基本フロー（Main Flow）

| ステップ | アクター | システム |
|---------|---------|---------|
| 1 | 「新規登録」リンクをクリック | |
| 2 | | 登録フォームを表示 |
| 3 | メールアドレス、パスワード、名前を入力し「登録」をクリック | |
| 4 | | 入力値を検証 |
| 5 | | ユーザーアカウントを作成 |
| 6 | | 確認メールを送信 |
| 7 | | 登録完了画面を表示、自動ログイン |

#### 代替フロー（Alternative Flows）

**A1: 入力値が不正な場合（ステップ4で発生）**

| ステップ | アクター | システム |
|---------|---------|---------|
| 4a | | エラーメッセージを該当フィールドに表示 |
| 4b | 入力を修正して再送信 | |

**A2: メールアドレスが既に登録済みの場合（ステップ4で発生）**

| ステップ | アクター | システム |
|---------|---------|---------|
| 4a | | 「このメールアドレスは既に登録されています」を表示 |
| 4b | | 「ログイン」と「パスワードリセット」のリンクを提示 |

#### 例外フロー（Exception Flows）

**E1: メール送信失敗**

| ステップ | アクター | システム |
|---------|---------|---------|
| 6a | | エラーログを記録 |
| 6b | | 「登録は完了しましたが、確認メールの送信に失敗しました。再送信をお試しください」を表示 |

#### ビジネスルール

- パスワードは8文字以上、英数字混在必須
- メールアドレスは小文字に正規化して保存
- 確認メールの有効期限は24時間

#### 補足・備考

- OAuth（Google、GitHub）による登録は別ユースケース（UC-001a）で定義

---

## 5. 優先度マトリクス

### MoSCoW分析

#### Must Have（必須）

| UC-ID | ユースケース名 | 理由 |
|-------|--------------|------|
| UC-001 | [ユーザー登録] | [サービス利用の前提] |
| UC-002 | [ログイン] | [サービス利用の前提] |
| [追加] | | |

#### Should Have（重要）

| UC-ID | ユースケース名 | 理由 |
|-------|--------------|------|
| UC-003 | [パスワードリセット] | [ユーザビリティ必須機能] |
| [追加] | | |

#### Could Have（あると良い）

| UC-ID | ユースケース名 | 理由 |
|-------|--------------|------|
| [追加] | | |

#### Won't Have（今回はやらない）

| UC-ID | ユースケース名 | 理由 |
|-------|--------------|------|
| [追加] | | |

---

## 6. CRUD マトリクス

### エンティティ × ユースケース

| エンティティ | UC-001 | UC-002 | UC-003 | UC-101 | UC-102 |
|-------------|--------|--------|--------|--------|--------|
| ユーザー | C | R | U | R | R |
| 商品 | - | - | - | R | R |
| 注文 | - | - | - | - | - |
| カート | - | - | - | - | CU |

C: Create, R: Read, U: Update, D: Delete

---

## 7. トレーサビリティマトリクス

### 要件 × ユースケース

| 要件ID | 要件名 | 関連ユースケース |
|--------|--------|----------------|
| REQ-001 | [ユーザー認証] | UC-001, UC-002, UC-003 |
| REQ-002 | [商品検索] | UC-101 |
| REQ-003 | [カート機能] | UC-102, UC-103 |
| [追加] | | |

---

## AIプロンプト例

### ユースケースの洗い出し

```
以下のシステム概要から、必要なユースケースを洗い出してください：

【システム概要】
[システムの説明をここに記入]

【アクター】
- [アクター1]
- [アクター2]

以下の形式で出力してください：
- カテゴリ別に整理
- 優先度（高/中/低）を付与
- 各ユースケースの概要を一言で

また、見落としがちなユースケース（エラー処理、管理機能など）も指摘してください。
```

### ユースケースの詳細化

```
以下のユースケースを詳細化してください：

【ユースケース名】
[名前]

【概要】
[簡単な説明]

【アクター】
[アクター名]

以下を含めてください：
1. 事前条件・事後条件
2. 基本フロー（ステップバイステップ）
3. 代替フロー（最低2つ）
4. 例外フロー
5. ビジネスルール
6. 画面遷移のイメージ
```

### テストケースへの変換

```
以下のユースケースから、テストケースを生成してください：

[ユースケースの内容をコピー＆ペースト]

以下を含めてください：
1. 正常系テストケース
2. 異常系テストケース（各代替フロー・例外フロー）
3. 境界値テストケース
4. テストデータの例
```

### ユースケース図の生成

```
以下のユースケース一覧から、PlantUML形式のユースケース図を生成してください：

【アクター】
[アクター一覧]

【ユースケース】
[ユースケース一覧]

include/extend関係があれば適切に表現してください。
```

---

## 記入完了チェックリスト

- [ ] アクター定義（プライマリ・セカンダリ）完了
- [ ] ユースケース一覧作成完了
- [ ] 優先度設定完了
- [ ] Must Haveユースケースの詳細記述完了
- [ ] Should Haveユースケースの詳細記述完了
- [ ] CRUDマトリクス作成完了
- [ ] 要件トレーサビリティ確認完了
- [ ] AIレビュー実施完了
- [ ] ステークホルダーレビュー完了

---

**作成日**: [YYYY-MM-DD]
**最終更新**: [YYYY-MM-DD]
**作成者**: [名前]
**レビュアー**: [名前]
