---
title: "DECISION_MATRIX"
version: "1.0.0"
status: "draft"
owner: "@your-github-handle"
created: "YYYY-MM-DD"
updated: "YYYY-MM-DD"
---

# Decision Matrix — 「どの文書に書く？」判断ガイド

## このガイドの目的

7文書体制で開発を進める際、「この情報はどの文書に書けばいい？」と迷う場面は必ず発生する。本ガイドは以下の3つのツールで判断を支援する。

1. **Decision Matrix** — 質問の種類から代表文書を特定するフローチャート
2. **曖昧ケーステーブル** — 複数文書にまたがる典型的なケースの配置指針
3. **機能×文書 参照マトリクス** — 一覧表で代表文書と関連文書を俯瞰

## Decision Matrix（判断フローチャート）

「この情報はどの文書？」と迷ったら、まず**質問の種類**で分類する。

### ステップ1: 質問で分類する

| 質問 | 代表文書 | 補足 |
| ------ | --------- | ------ |
| **Why** — なぜ作るのか？ | PROJECT | ビジョン・目的・ビジネス背景 |
| **What** — 何を作るのか？ | PROJECT / DOMAIN | 要件はPROJECT、ビジネスルールはDOMAIN |
| **How（設計）** — どう構成するか？ | ARCHITECTURE | コンポーネント構成・技術選定・ADR |
| **Rules** — どんなルールがあるか？ | DOMAIN | エンティティ・値オブジェクト・ビジネス制約 |
| **How（実装）** — どう書くか？ | PATTERNS | コーディング規約・実装パターン・命名規則 |
| **Correct** — どう確かめるか？ | TESTING | テスト戦略・カバレッジ基準・テストパターン |
| **Operate** — どう動かすか？ | DEPLOYMENT | CI/CD・インフラ・監視・運用手順 |

### ステップ2: 最終判断基準

ステップ1で迷う場合、以下の基準を適用する。

> **「この情報が変わったとき、誰が気にするか？」**

| 気にする人 | 代表文書 |
| ----------- | --------- |
| ビジネス側（PO・ステークホルダー） | PROJECT / DOMAIN |
| 開発者（設計・アーキテクト） | ARCHITECTURE / PATTERNS |
| 運用担当（SRE・インフラ） | DEPLOYMENT |
| QA・テスト担当 | TESTING |

### 判断フロー図

```text
「この情報はどこに書く？」
    │
    ├─ なぜ作る？ ──────────────→ PROJECT
    │
    ├─ 何を作る？
    │   ├─ ビジネス要件 ────────→ PROJECT
    │   └─ ビジネスルール ──────→ DOMAIN
    │
    ├─ どう構成する？ ──────────→ ARCHITECTURE
    │
    ├─ どんなルールがある？ ────→ DOMAIN
    │
    ├─ どう書く？ ──────────────→ PATTERNS
    │
    ├─ どう確かめる？ ──────────→ TESTING
    │
    └─ どう動かす？ ────────────→ DEPLOYMENT

迷ったら → 「変わったとき誰が気にする？」で判断
```

## 曖昧ケーステーブル

実際の開発では、1つのテーマが複数の文書にまたがるケースが多い。以下のテーブルは典型的な曖昧ケースと、その配置指針を示す。

**読み方**: 「代表文書」に定義の本体を書き、「関連文書」には実装方法や運用手順を記載する。

| テーマ | 迷うポイント | 代表文書 | 関連文書 | 配置の考え方 |
| -------- | ------------ | --------- | --------- | ------------ |
| バリデーション | ビジネスルール？実装パターン？ | DOMAIN（ルール定義） | PATTERNS（実装方法） | 「メールは一意」はビジネスルール→DOMAIN、「どうチェックするか」は実装→PATTERNS |
| エラーコード | ドメイン知識？技術仕様？ | DOMAIN（コード体系・意味定義） | PATTERNS（実装・ハンドリング方針） | エラーコードの意味と体系はDOMAIN、コード上の扱い方はPATTERNS |
| 環境変数 | 設計判断？運用設定？ | ARCHITECTURE（設計・命名規則） | DEPLOYMENT（管理・シークレット運用） | どんな環境変数が必要かはARCHITECTURE、どう管理するかはDEPLOYMENT |
| ページネーション | API設計？実装パターン？ | ARCHITECTURE（API仕様・方式選定） | PATTERNS（実装パターン・ヘルパー） | カーソル方式 vs オフセット方式の選定はARCHITECTURE、具体的な実装はPATTERNS |
| 権限・ロール定義 | ビジネスルール？技術実装？ | DOMAIN（ロール体系・権限ルール） | ARCHITECTURE（認証認可の技術構成） | 「管理者はユーザーを削除できる」はDOMAIN、「RBACで実装しJWTにロールを含める」はARCHITECTURE |

### 判断に迷ったときのチェックリスト

上記テーブルに該当しないケースでは、以下を順に確認する。

1. **ビジネス側に説明が必要か？** → Yes: DOMAIN or PROJECT
2. **技術選定の判断が含まれるか？** → Yes: ARCHITECTURE
3. **コードの書き方に関するか？** → Yes: PATTERNS
4. **テストの方法に関するか？** → Yes: TESTING
5. **本番環境の運用に関するか？** → Yes: DEPLOYMENT

## 機能×文書 参照マトリクス

主要な機能領域ごとに、どの文書を参照すべきかを一覧化する。

**凡例**: ◎ = 代表文書（定義の本体）、○ = 関連情報あり、- = 通常不要

| 機能領域 | PROJECT | ARCHITECTURE | DOMAIN | PATTERNS | TESTING | DEPLOYMENT |
| --------- | --------- | ------------- | -------- | ---------- | --------- | ----------- |
| ユーザー認証 | ○ | ◎ | ○ | ○ | ○ | ○ |
| 権限・ロール | ○ | ○ | ◎ | ○ | ○ | - |
| データモデル | - | ○ | ◎ | ○ | ○ | - |
| API設計 | - | ◎ | ○ | ○ | ○ | - |
| バリデーション | - | - | ◎ | ○ | ○ | - |
| エラーハンドリング | - | ○ | ◎ | ◎ | ○ | ○ |
| ログ・監視 | - | ◎ | - | ○ | - | ◎ |
| キャッシュ戦略 | - | ◎ | - | ○ | ○ | ○ |
| CI/CD | - | ○ | - | - | ○ | ◎ |
| パフォーマンス | ○ | ◎ | - | ○ | ○ | ○ |
| セキュリティ | ○ | ◎ | ○ | ○ | ○ | ○ |
| 外部連携（API） | ○ | ◎ | ○ | ○ | ○ | ○ |
| UI/UX | ◎ | ○ | - | ○ | ○ | - |
| バッチ処理 | ○ | ◎ | ○ | ○ | ○ | ◎ |
| 通知・メール | ○ | ○ | ◎ | ○ | ○ | ○ |

### マトリクスの使い方

1. **新機能の実装前**: 該当する機能領域の行を確認し、◎の文書を必ず読む
2. **ドキュメント更新時**: ◎の文書を更新したら、○の文書にも影響がないか確認する
3. **レビュー時**: PRの変更内容に対応する機能領域を特定し、◎の文書との整合性を確認する

## 関連ドキュメント

- [MASTER.md](../MASTER.md) - 7文書の全体構成と運用ルール
- [PROJECT.md](../01-context/PROJECT.md) - ビジョンと要件
- [ARCHITECTURE.md](../02-design/ARCHITECTURE.md) - システム設計
- [DOMAIN.md](../02-design/DOMAIN.md) - ビジネスロジック
- [PATTERNS.md](../03-implementation/PATTERNS.md) - 実装パターン
- [TESTING.md](../04-quality/TESTING.md) - テスト戦略
- [DEPLOYMENT.md](../05-operations/DEPLOYMENT.md) - デプロイ戦略
